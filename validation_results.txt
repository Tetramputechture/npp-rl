/openhands/micromamba/envs/openhands/lib/python3.12/site-packages/pygame/pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
============================================================
NPP-RL Architecture Validation
============================================================

This script validates that all architectures can perform
forward passes with realistic N++ graph observations.

Found 11 architectures to validate


############################################################
# Testing with 100 edges
############################################################

============================================================
Testing: full_hgt
============================================================
Description: Full HGT with all modalities: temporal frames, global view, graph, state, reachability
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.071s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ full_hgt PASSED
============================================================

============================================================
Testing: simplified_hgt
============================================================
Description: Simplified HGT: reduced layers and dimensions
Modalities: temporal, global, graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 13.829s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ simplified_hgt PASSED
============================================================

============================================================
Testing: gat
============================================================
Description: Graph Attention Network with all modalities
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 22.163s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ gat PASSED
============================================================

============================================================
Testing: gcn
============================================================
Description: Graph Convolutional Network (simplest graph baseline)
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.578s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ gcn PASSED
============================================================

============================================================
Testing: mlp_baseline
============================================================
Description: MLP baseline: no graph processing, only vision and state
Modalities: temporal, global, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.007s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ mlp_baseline PASSED
============================================================

============================================================
Testing: vision_free
============================================================
Description: Vision-free: graph + state + reachability only
Modalities: graph, state, reachability
Features dim: 384

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.010s
  Output shape: torch.Size([2, 384])
  Expected shape: (2, 384)
✓ Output validation passed

============================================================
✓ vision_free PASSED
============================================================

============================================================
Testing: vision_free_gat
============================================================
Description: Vision-free with Graph Attention Network (lighter than HGT)
Modalities: graph, state, reachability
Features dim: 384

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 21.805s
  Output shape: torch.Size([2, 384])
  Expected shape: (2, 384)
✓ Output validation passed

============================================================
✓ vision_free_gat PASSED
============================================================

============================================================
Testing: vision_free_gcn
============================================================
Description: Vision-free with Graph Convolutional Network (fastest graph option)
Modalities: graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.610s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ vision_free_gcn PASSED
============================================================

============================================================
Testing: vision_free_simplified
============================================================
Description: Vision-free with simplified HGT (reduced complexity)
Modalities: graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 13.694s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ vision_free_simplified PASSED
============================================================

============================================================
Testing: no_global_view
============================================================
Description: Full architecture but without global view
Modalities: temporal, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.014s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ no_global_view PASSED
============================================================

============================================================
Testing: local_frames_only
============================================================
Description: Temporal frames + graph + state (no global view)
Modalities: temporal, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=100)...
Testing forward pass...
✓ Forward pass completed in 0.012s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ local_frames_only PASSED
============================================================

############################################################
# Testing with 1000 edges
############################################################

============================================================
Testing: full_hgt
============================================================
Description: Full HGT with all modalities: temporal frames, global view, graph, state, reachability
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.066s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ full_hgt PASSED
============================================================

============================================================
Testing: simplified_hgt
============================================================
Description: Simplified HGT: reduced layers and dimensions
Modalities: temporal, global, graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 14.480s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ simplified_hgt PASSED
============================================================

============================================================
Testing: gat
============================================================
Description: Graph Attention Network with all modalities
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 21.982s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ gat PASSED
============================================================

============================================================
Testing: gcn
============================================================
Description: Graph Convolutional Network (simplest graph baseline)
Modalities: temporal, global, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.601s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ gcn PASSED
============================================================

============================================================
Testing: mlp_baseline
============================================================
Description: MLP baseline: no graph processing, only vision and state
Modalities: temporal, global, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.008s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ mlp_baseline PASSED
============================================================

============================================================
Testing: vision_free
============================================================
Description: Vision-free: graph + state + reachability only
Modalities: graph, state, reachability
Features dim: 384

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.065s
  Output shape: torch.Size([2, 384])
  Expected shape: (2, 384)
✓ Output validation passed

============================================================
✓ vision_free PASSED
============================================================

============================================================
Testing: vision_free_gat
============================================================
Description: Vision-free with Graph Attention Network (lighter than HGT)
Modalities: graph, state, reachability
Features dim: 384

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 21.574s
  Output shape: torch.Size([2, 384])
  Expected shape: (2, 384)
✓ Output validation passed

============================================================
✓ vision_free_gat PASSED
============================================================

============================================================
Testing: vision_free_gcn
============================================================
Description: Vision-free with Graph Convolutional Network (fastest graph option)
Modalities: graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.591s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ vision_free_gcn PASSED
============================================================

============================================================
Testing: vision_free_simplified
============================================================
Description: Vision-free with simplified HGT (reduced complexity)
Modalities: graph, state, reachability
Features dim: 256

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 13.690s
  Output shape: torch.Size([2, 256])
  Expected shape: (2, 256)
✓ Output validation passed

============================================================
✓ vision_free_simplified PASSED
============================================================

============================================================
Testing: no_global_view
============================================================
Description: Full architecture but without global view
Modalities: temporal, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.068s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ no_global_view PASSED
============================================================

============================================================
Testing: local_frames_only
============================================================
Description: Temporal frames + graph + state (no global view)
Modalities: temporal, graph, state, reachability
Features dim: 512

Creating feature extractor...
✓ Feature extractor created

Creating mock observations (batch_size=2, edges=1000)...
Testing forward pass...
✓ Forward pass completed in 0.067s
  Output shape: torch.Size([2, 512])
  Expected shape: (2, 512)
✓ Output validation passed

============================================================
✓ local_frames_only PASSED
============================================================

============================================================
VALIDATION SUMMARY
============================================================

Total architectures: 11
Passed: 11
Failed: 0

Detailed Results:
------------------------------------------------------------
✓ PASS   full_hgt                   0.066s (1000 edges)
✓ PASS   simplified_hgt             14.480s (1000 edges)
✓ PASS   gat                        21.982s (1000 edges)
✓ PASS   gcn                        0.601s (1000 edges)
✓ PASS   mlp_baseline               0.008s (1000 edges)
✓ PASS   vision_free                0.065s (1000 edges)
✓ PASS   vision_free_gat            21.574s (1000 edges)
✓ PASS   vision_free_gcn            0.591s (1000 edges)
✓ PASS   vision_free_simplified     13.690s (1000 edges)
✓ PASS   no_global_view             0.068s (1000 edges)
✓ PASS   local_frames_only          0.067s (1000 edges)
============================================================
